<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ggpaintr">
<title>Introduction to ggpaintr • ggpaintr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ggpaintr">
<meta property="og:description" content="ggpaintr">
<meta property="og:image" content="https://willju-wangqian.github.io/ggpaintr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ggpaintr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro-ggpaintr.html">Introduction to ggpaintr</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to ggpaintr</h1>
            
      
      
      <div class="d-none name"><code>intro-ggpaintr.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="grammar-of-graphics-ggplot2">Grammar of Graphics &amp; ggplot2<a class="anchor" aria-label="anchor" href="#grammar-of-graphics-ggplot2"></a>
</h3>
<p>First proposed by <span class="citation">(<a href="#ref-Wilkinson2005">Wilkinson, Anand, and Grossman
2005</a>)</span>, the grammar of graphics defines a way of concisely
breaking up graphs into semantic components for data visualization.
Analogous to the grammar in English, the grammar of graphics tells us
which “words” should be used to make up a “sentence”. It allows users to
create a complex graphic by assembling multiple independent
components.</p>
<p>The open-sourced R package <code>ggplot2</code> <span class="citation">(<a href="#ref-Wickham2010">Hadley Wickham
2010</a>)</span> implemented this grammar of graphics with some
modifications and refinements, leading to what is now called a ‘’layered
grammar’’. <code>ggplot2</code> built a mapping from the data to
geometric objects in multiple different layers drawn on a coordinate
system. As an example, the code following this layered grammar to
complete a line chart can include:</p>
<ul>
<li><p>A base layer with raw data;</p></li>
<li><p>A layer for drawing the lines;</p></li>
<li><p>A layer for specifying x, y labels and the title;</p></li>
<li><p>A layer for legend settings;</p></li>
<li><p>A layer for choosing background theme;</p></li>
<li><p>…</p></li>
</ul>
<p>Each of the above functionalities can be modularized into one or
several functions. Modules are assembled together at high level of
abstraction according to the “grammar” of <code>ggplot2</code>, to
eventually show the graphic we desire.</p>
<p>Compared to the plotting functions in vanilla R, <code>ggplot2</code>
is more convenient to use, with higher flexibility and readability. It
is considered one of the most popular R package <span class="citation">(<a href="#ref-Wickham2016">H. Wickham
2016</a>)</span>.</p>
</div>
<div class="section level3">
<h3 id="building-a-shiny-app-with-graphical-visualization">Building a Shiny App with Graphical Visualization<a class="anchor" aria-label="anchor" href="#building-a-shiny-app-with-graphical-visualization"></a>
</h3>
<p>Shiny is a framework for creating web applications from R. Shiny apps
built from <a href="https://shiny.rstudio.com/" class="external-link">R shiny</a> help users
interact with the data instead of facing the ice-cold coding console.
Together with <code>ggplot2</code>, it provides possibility of creating
elegant data visualizations with large flexibility. Interactive
graphical visualizations are extremely helpful in presentations or
statistical education <span class="citation">(<a href="#ref-Doi2016">Doi
et al. 2016</a>)</span>, for providing the audience with a clear and
straight forward view of data analysis.</p>
<p>However, the procedure of building such a fancy shiny app may not be
as fancy as it comes out. It requires an extensive knowledge about shiny
and comes at a cost of heavy and tedious programming work:</p>
<ul>
<li>The implementation of each component in the grammar of graphics
requires an unignorable amount of coding;</li>
<li>Some functionalities in <code>ggplot2</code> may not be able to
realized easily and intuitively in shiny (e.g., the customization of
colors);</li>
<li>Most importantly, apart from the code for individual ggplot
components, there’s a lot of extra work to do for assembling them into a
real shiny app.</li>
</ul>
</div>
<div class="section level3">
<h3 id="our-contribution">Our Contribution<a class="anchor" aria-label="anchor" href="#our-contribution"></a>
</h3>
<p>In this manuscript we introduce our package
<strong>ggpaintr</strong>, <span style="color:red">a package for
building shiny apps</span> with ggplot2 visualizations. Using our
package, the programming work for building a data-visualization shiny
app can be dramatically reduced, while the coding structure is rather
simplified and mimics the way ggplot2 works in R.</p>
</div>
</div>
<div class="section level2">
<h2 id="why-ggpaintr-can-be-useful">Why ggpaintr can be useful<a class="anchor" aria-label="anchor" href="#why-ggpaintr-can-be-useful"></a>
</h2>
<p>The goal of <code>ggpaintr</code> is to make it easy for writing
shiny apps. <code>ggpaintr</code> is a collection of highly modularized
shiny app components. It offers the possibility to build a shiny app for
ggplot2 data visualization with minimum effort. The resulting shiny app
can achieve broader functionality than the <a href="https://shiny.gmw.rug.nl/ggplotgui" class="external-link">ggplot GUI</a>, while the code
to accomplish this is much more readable and logical.</p>
<p>Our package has the following advantages:</p>
<ol style="list-style-type: decimal">
<li>
<p>Simplicity</p>
<p>Not only is the code using <code>ggpaintr</code> much shorter, it is
also much more readable comparing to using vanilla shiny
functions.</p>
</li>
<li>
<p>Flexibility</p>
<p>We have implemented ready-to-use modules in <code>ggpaintr</code> for
most of the commonly used <code>ggplot2</code> arguments. By calling
those modules directly users can achieve almost any complex
functionality they desire. As an example, a shiny app built from our
pacakge can achieve the following visualization:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">color</span>, <span class="va">fill</span><span class="op">)</span>, <span class="va">size</span>, <span class="va">alpha</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="va">w</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">...</span>, y <span class="op">=</span> <span class="va">...</span>, title <span class="op">=</span> <span class="va">...</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">...</span></span></code></pre></div>
</li>
<li>
<p>Extensibility</p>
<p>Moreover, if you are familiar with shiny and want to extend the
functionality to something we haven’t implemented, our package also
offers the ability (and instructions) of providing your own ui and
server functions, and even adding new modules into the package
(?).</p>
</li>
</ol>
<p><code>ggpaintr</code> is a user-friendly package. Anyone with some
knowledge of <code>ggplot2</code> can start building a shiny app with
basic ggplot output like the one shown below, after a self-teaching of
<code>ggpaintr</code> for less than 10 minutes:</p>
<!-- <img alt = '' height='400' width='600' src='images/ggpaintr(iris).png' /> -->
<div class="figure">
<img src="images/ggpaintr_iris_1.png" alt="Sample Iris Shiny App" width="100%"><p class="caption">
Sample Iris Shiny App
</p>
</div>
<p>And more complex options and functionalities can be added and
achieved using similar logic within a few lines of code. Currently
<code>ggpaintr</code> has implemented most of the commonly used ggplot2
functions and their parameter options. You will learn in details about
how to implement them in the next section.</p>
<p>We expect this package to be useful in the following scenarios:</p>
<ul>
<li>
<p>Statistical education of graphics</p>
<p>Our package offers a easier and more flexible way of building
graphical shiny apps. Statistics instructors can develop interactive
graphical UIs on their own with their specific demands. By transforming
R’s programming language into a point-and-click style, these UIs can be
used to introduce different statistical graphics to fresh students in
this field.</p>
</li>
<li>
<p>Statistical education of <code>R</code> /
<code>ggplot2</code></p>
<p>Along with the plot, shiny apps built from our package also
interactively show the complete R code for generating such plot. This
can be extremely useful for beginners in R or ggplot2.</p>
</li>
<li>
<p>Graphical demos in presentation</p>
<p>The most important characteristic of <code>ggpaintr</code> is that
users can customize their app based on their demand and preference. We
have implemented modules for most of the commonly used functionalities
in ggplot2, and the grammar used in <code>ggpaintr</code> is also
similar. As long as you are familiar with ggplot2, you should not find
it hard to build your own shiny app. With some extra knowledge of shiny,
you also have the ability to convert it into a fancier style as a formal
presentation demo.</p>
</li>
</ul>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>You can install the development version from Github with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"willju-wangqian/ggpaintr"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="case-study-1-ggpaintr-demo">Case Study 1: <code>ggpaintr</code> demo<a class="anchor" aria-label="anchor" href="#case-study-1-ggpaintr-demo"></a>
</h2>
<p>Let’s revisit the demo shiny app presented in Figure X. After
selecting a dataset, the shiny app allows users to map variables (or
columns) in the dataset to <code>x</code> and <code>y</code>. It
generates a plot using <code>ggplot2</code> and shows the corresponding
<code>R</code> code. The reactivity on the mappings are built up so that
changing mappings variables for <code>x</code> or <code>y</code> will
change the resulting plot after clicking the “draw” button. Moreover,
changing the selected dataset will automatically update the available
choices for <code>x</code> and <code>y</code>. Without the help of
<code>ggpaintr</code>, building such a shiny app at least requires the
following steps:</p>
<ul>
<li>have UI components for <code>x</code> and <code>y</code> so that
<code>input$x</code> and <code>input$y</code> are available</li>
<li>dynamically render UI components for <code>x</code> and
<code>y</code> so that the available choices depend on the selected data
set</li>
<li>figure out how to generate a <code>ggplot2</code> plot using
<code>input$x</code> and <code>input$y</code> since the inputs are
strings. One option is to use <code><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string()</a></code>
</li>
<li>figure out the <code>R</code> code for generating the resulting
plot</li>
<li>render the plot</li>
<li>render the code</li>
</ul>
<p>This might look involved, but what if this shiny app needs more
functionalities? If the shiny app needs more mappings, such as
<code>color</code> or <code>fill</code>, it will add more UI component,
modify the server part so that the inputs can be correctly captured. If
the shiny app wants to allow users to flip the coordinates using
<code><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip()</a></code> or adding labels using <code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs()</a></code>,
building this shiny app becomes even more involved. Additionally,
maintaining and updating the shiny app can be challenging as well since
many aspects of the shiny app would be modified.</p>
<p>However, we can build such a shiny app using <code>ggpaintr</code>
with the following code.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(ggpaintr)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">library</span>(shiny)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">library</span>(shinyWidgets)</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co"># Define UI for application that draws a histogram</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb3-9"><a href="#cb3-9"></a>  </span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="co"># Application title</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>  <span class="fu">titlePanel</span>(<span class="st">"ggpaintr demo"</span>),</span>
<span id="cb3-12"><a href="#cb3-12"></a>  </span>
<span id="cb3-13"><a href="#cb3-13"></a>  <span class="co"># Sidebar with a slider input for number of bins</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb3-15"><a href="#cb3-15"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb3-16"><a href="#cb3-16"></a>      <span class="fu">pickerInput</span>(<span class="st">"defaultData"</span>, <span class="st">"select a default dataset:"</span>,</span>
<span id="cb3-17"><a href="#cb3-17"></a>                  <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"iris"</span>, <span class="st">"mtcars"</span>,<span class="st">"penguins"</span>, <span class="st">"faithfuld"</span>),</span>
<span id="cb3-18"><a href="#cb3-18"></a>                  <span class="at">selected =</span> <span class="st">""</span>,</span>
<span id="cb3-19"><a href="#cb3-19"></a>                  <span class="at">multiple =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-20"><a href="#cb3-20"></a>                  <span class="at">options =</span> <span class="fu">pickerOptions</span>(<span class="at">maxOptions =</span> <span class="dv">1</span>)),</span>
<span id="cb3-21"><a href="#cb3-21"></a>      <span class="fu">uiOutput</span>(<span class="st">"controlPanel"</span>),</span>
<span id="cb3-22"><a href="#cb3-22"></a>      <span class="fu">actionButton</span>(<span class="st">"draw"</span>, <span class="st">"click to draw the plot"</span>),</span>
<span id="cb3-23"><a href="#cb3-23"></a>    ),</span>
<span id="cb3-24"><a href="#cb3-24"></a>    </span>
<span id="cb3-25"><a href="#cb3-25"></a>    <span class="co"># Show a plot of the generated distribution</span></span>
<span id="cb3-26"><a href="#cb3-26"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb3-27"><a href="#cb3-27"></a>      <span class="fu">plotOutput</span>(<span class="st">"outputPlot"</span>),</span>
<span id="cb3-28"><a href="#cb3-28"></a>      <span class="fu">verbatimTextOutput</span>(<span class="st">'outputCode'</span>)</span>
<span id="cb3-29"><a href="#cb3-29"></a>    )</span>
<span id="cb3-30"><a href="#cb3-30"></a>  )</span>
<span id="cb3-31"><a href="#cb3-31"></a>)</span>
<span id="cb3-32"><a href="#cb3-32"></a></span>
<span id="cb3-33"><a href="#cb3-33"></a><span class="co"># Define server logic required to draw a histogram</span></span>
<span id="cb3-34"><a href="#cb3-34"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb3-35"><a href="#cb3-35"></a>  </span>
<span id="cb3-36"><a href="#cb3-36"></a>  control_id <span class="ot">&lt;-</span> <span class="st">"control_id"</span></span>
<span id="cb3-37"><a href="#cb3-37"></a>  </span>
<span id="cb3-38"><a href="#cb3-38"></a>  <span class="co"># data</span></span>
<span id="cb3-39"><a href="#cb3-39"></a>  data_container <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb3-40"><a href="#cb3-40"></a>    <span class="fu">req</span>(input<span class="sc">$</span>defaultData)</span>
<span id="cb3-41"><a href="#cb3-41"></a>    <span class="fu">get</span>(input<span class="sc">$</span>defaultData)</span>
<span id="cb3-42"><a href="#cb3-42"></a>  })</span>
<span id="cb3-43"><a href="#cb3-43"></a>  </span>
<span id="cb3-44"><a href="#cb3-44"></a>  <span class="co"># construct paintr object</span></span>
<span id="cb3-45"><a href="#cb3-45"></a>  paintr_rctv <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb3-46"><a href="#cb3-46"></a>    </span>
<span id="cb3-47"><a href="#cb3-47"></a>    <span class="fu">req</span>(<span class="fu">data_container</span>())</span>
<span id="cb3-48"><a href="#cb3-48"></a>    </span>
<span id="cb3-49"><a href="#cb3-49"></a>    <span class="fu">paintr</span>(control_id,</span>
<span id="cb3-50"><a href="#cb3-50"></a>           <span class="fu">data_container</span>(), <span class="at">data_path =</span> input<span class="sc">$</span>defaultData,</span>
<span id="cb3-51"><a href="#cb3-51"></a>           <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(x, y)) </span>
<span id="cb3-52"><a href="#cb3-52"></a>    )</span>
<span id="cb3-53"><a href="#cb3-53"></a>    </span>
<span id="cb3-54"><a href="#cb3-54"></a>  })</span>
<span id="cb3-55"><a href="#cb3-55"></a>  </span>
<span id="cb3-56"><a href="#cb3-56"></a>  <span class="co"># place ui</span></span>
<span id="cb3-57"><a href="#cb3-57"></a>  output<span class="sc">$</span>controlPanel <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb3-58"><a href="#cb3-58"></a>    <span class="fu">req</span>(<span class="fu">paintr_rctv</span>())</span>
<span id="cb3-59"><a href="#cb3-59"></a>    </span>
<span id="cb3-60"><a href="#cb3-60"></a>    <span class="fu">column</span>(</span>
<span id="cb3-61"><a href="#cb3-61"></a>      <span class="dv">12</span>,</span>
<span id="cb3-62"><a href="#cb3-62"></a>      <span class="fu">paintr_get_ui</span>(<span class="fu">paintr_rctv</span>(), <span class="st">"x"</span>),</span>
<span id="cb3-63"><a href="#cb3-63"></a>      <span class="fu">paintr_get_ui</span>(<span class="fu">paintr_rctv</span>(), <span class="st">"y"</span>),</span>
<span id="cb3-64"><a href="#cb3-64"></a>    )</span>
<span id="cb3-65"><a href="#cb3-65"></a>  })</span>
<span id="cb3-66"><a href="#cb3-66"></a>  </span>
<span id="cb3-67"><a href="#cb3-67"></a>  <span class="co"># take results and plot</span></span>
<span id="cb3-68"><a href="#cb3-68"></a>  <span class="fu">observe</span>({</span>
<span id="cb3-69"><a href="#cb3-69"></a>    <span class="fu">req</span>(<span class="fu">paintr_rctv</span>(), <span class="fu">data_container</span>(), input<span class="sc">$</span>defaultData)</span>
<span id="cb3-70"><a href="#cb3-70"></a>    data <span class="ot">&lt;-</span> <span class="fu">data_container</span>()</span>
<span id="cb3-71"><a href="#cb3-71"></a>    </span>
<span id="cb3-72"><a href="#cb3-72"></a>    paintr_results <span class="ot">&lt;-</span> <span class="fu">paintr_plot_code</span>(<span class="fu">paintr_rctv</span>())</span>
<span id="cb3-73"><a href="#cb3-73"></a>    </span>
<span id="cb3-74"><a href="#cb3-74"></a>    <span class="co"># Plot output</span></span>
<span id="cb3-75"><a href="#cb3-75"></a>    output<span class="sc">$</span>outputPlot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb3-76"><a href="#cb3-76"></a>      </span>
<span id="cb3-77"><a href="#cb3-77"></a>      paintr_results[[<span class="st">'plot'</span>]]</span>
<span id="cb3-78"><a href="#cb3-78"></a>      </span>
<span id="cb3-79"><a href="#cb3-79"></a>    })</span>
<span id="cb3-80"><a href="#cb3-80"></a>    </span>
<span id="cb3-81"><a href="#cb3-81"></a>    <span class="co"># Code output</span></span>
<span id="cb3-82"><a href="#cb3-82"></a>    output<span class="sc">$</span>outputCode <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb3-83"><a href="#cb3-83"></a>      </span>
<span id="cb3-84"><a href="#cb3-84"></a>      paintr_results[[<span class="st">'code'</span>]]</span>
<span id="cb3-85"><a href="#cb3-85"></a>      </span>
<span id="cb3-86"><a href="#cb3-86"></a>    })</span>
<span id="cb3-87"><a href="#cb3-87"></a>    </span>
<span id="cb3-88"><a href="#cb3-88"></a>  }) <span class="sc">%&gt;%</span> <span class="fu">bindEvent</span>(input<span class="sc">$</span>draw)</span>
<span id="cb3-89"><a href="#cb3-89"></a>  </span>
<span id="cb3-90"><a href="#cb3-90"></a>  </span>
<span id="cb3-91"><a href="#cb3-91"></a>}</span>
<span id="cb3-92"><a href="#cb3-92"></a></span>
<span id="cb3-93"><a href="#cb3-93"></a><span class="co"># Run the application</span></span>
<span id="cb3-94"><a href="#cb3-94"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
<p>Many things are hidden and handled by functions in
<code>ggpaintr</code>, and we will talk about it in detail in the next
section. Updating this shiny app can be relatively easy with the help of
<code>ggpaintr</code>: by changing the <code>ggplot2</code> alike
expression at line 51 into</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add mapping for fill</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">fill</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">coord_flip</span> <span class="op">+</span>        <span class="co"># allow users to flip coordinate</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">title</span><span class="op">)</span>   <span class="co"># allow users to add labels for x-axis, y-axis, and title</span></span></code></pre></div>
<p>and adding more elements in
<code>output$controlPanel &lt;- renderUI()</code> at line 57:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># place ui</span></span>
<span><span class="va">output</span><span class="op">$</span><span class="va">controlPanel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html" class="external-link">renderUI</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html" class="external-link">req</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/column.html" class="external-link">column</a></span><span class="op">(</span></span>
<span>    <span class="fl">12</span>,</span>
<span>    <span class="fu"><a href="../reference/paintr_get_ui.html">paintr_get_ui</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span>, <span class="st">"x"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/paintr_get_ui.html">paintr_get_ui</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span>, <span class="st">"y"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/paintr_get_ui.html">paintr_get_ui</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span>, <span class="st">"fill"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/paintr_get_ui.html">paintr_get_ui</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span>, <span class="st">"coord_flip"</span><span class="op">)</span>, <span class="co"># add UI for coord_flip()</span></span>
<span>    <span class="fu"><a href="../reference/paintr_get_ui.html">paintr_get_ui</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span>, <span class="st">"labs"</span><span class="op">)</span>,       <span class="co"># add UI for labs()</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>we can build a shiny app with the updated features as shown in Figure
X. We can see that the shiny app now allows users to flip coordinates
and set labels. The plot and corresponding <code>R</code> code can be
updated accordingly as well.</p>
<div class="figure">
<img src="images/ggpaintr_iris_2.png" alt="An Extended Iris Shiny App" width="100%"><p class="caption">
An Extended Iris Shiny App
</p>
</div>
</div>
<div class="section level2">
<h2 id="ggpaintr-design-desicisions">
<code>ggpaintr</code> Design Desicisions<a class="anchor" aria-label="anchor" href="#ggpaintr-design-desicisions"></a>
</h2>
<div class="section level3">
<h3 id="basic-structure">Basic Structure<a class="anchor" aria-label="anchor" href="#basic-structure"></a>
</h3>
<p>Making a shiny app with <code>ggpaintr</code> is straightforward.
Since the UI components of mapping (and other plot settings like
<code><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip()</a></code> or <code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs()</a></code>) are dynamically
rendered, we will need a <code>uiOutput(id)</code> on the UI side that
serves as a placeholder for the dynamically rendered UIs, like line 21
in the code of the demo shiny app. Another thing needed on the UI side
is an action button, which is closely related to the design on the
server side. On the server side, there are three building blocks that we
need to take care of:</p>
<ul>
<li>
<p>creating a <code>paintr_obj</code> object using
<code><a href="../reference/paintr.html">ggpaintr::paintr()</a></code> as a reactive value (line 45).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/paintr.html">paintr</a></span><span class="op">(</span></span>
<span>  <span class="va">id</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">expr</span>,</span>
<span>  extra_ui <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extra_ui_args <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data_path <span class="op">=</span> <span class="st">"data"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/paintr.html">paintr()</a></code> is the main function of <code>ggpaintr</code>
and returns a <code>paintr_obj</code> object. It expects three
arguments:</p>
<ul>
<li>
<code>id</code>: this ID will be used to create a
<code>namespace</code> shared by all UI and module servers related to
this <code>paintr_obj</code> object.</li>
<li>
<code>data</code>: the dataset used to generate the plot</li>
<li>
<code>expr</code>: an expression that controls which functionality
should be included in the shiny app.</li>
</ul>
<p>Note that wrapping the <code>paintr_obj</code> with
<code><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive()</a></code> is not required by the <code><a href="../reference/paintr.html">paintr()</a></code>
function, but required by the reactivity in the shiny app. Therefore,
one can create a <code>paintr_obj</code> using <code><a href="../reference/paintr.html">paintr()</a></code> and
inspect its structure and elements even outside the context of a shiny
app:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_paintr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/paintr.html">paintr</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="va">iris</span>, </span>
<span>                    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">fill</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>extract the UI element using
<code><a href="../reference/paintr_get_ui.html">ggpaintr::paintr_get_ui()</a></code> (line 62).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/paintr_get_ui.html">paintr_get_ui</a></span><span class="op">(</span></span>
<span>  <span class="va">paintr_obj</span>,</span>
<span>  <span class="va">selected_ui_name</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"ui"</span>,</span>
<span>  scope <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/paintr_get_ui.html">paintr_get_ui()</a></code> expects a <code>paintr_obj</code> object
and a selected key name for the ui. This selected key name can be any
key name that has been implemented in <code>ggpaintr</code> or a
user-defined key name. This will be discussed later in detail.
<code><a href="../reference/paintr_get_ui.html">paintr_get_ui()</a></code> returns the UI element of the selected key
name and returns <code>NULL</code> if the selected key name is not
included in the <code>expr</code> of <code><a href="../reference/paintr.html">paintr()</a></code>.
<code><a href="../reference/paintr_get_ui.html">paintr_get_ui()</a></code> can be used to obtain the ID of the
selected UI element if <code>type = "id"</code>. This is useful since
the ID of the UI element of a selected key name can potentially be
arbitrary if the UI function is user-defined.</p>
</li>
<li>
<p>generate the plot and corresponding <code>R</code> code using
<code><a href="../reference/paintr_plot_code.html">paintr_plot_code()</a></code> (line 72)</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/paintr_plot_code.html">paintr_plot_code</a></span><span class="op">(</span></span>
<span>  <span class="va">paintr_obj</span>,</span>
<span>  selected_color_rctv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  selected_fill_rctv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  color_fill <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  color_group <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  userFUN <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/paintr_plot_code.html">paintr_plot_code()</a></code> takes a <code>paintr_obj</code>
object and executes all of the module server functions in order to
generate the resulting plot using <code>ggplot2</code> and the
corresponding <code>R</code> code. Note that
<code><a href="../reference/paintr_plot_code.html">paintr_plot_code()</a></code> is designed to be wrapped by
<code><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent()</a></code>, or equivalently by the combination of
<code>observe</code> and <code>bindEvent</code> introduced by Shiny
1.6.0. The <code><a href="https://rdrr.io/pkg/shiny/man/isolate.html" class="external-link">isolate()</a></code> environment provided by
<code><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent()</a></code> can prevent the module server functions from
execution when necessary pieces are missing. As a result, an action
button that controls <code><a href="../reference/paintr_plot_code.html">paintr_plot_code()</a></code> and
<code><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent()</a></code> is expected on the UI side.</p>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="control-with-expressions">Control with Expressions<a class="anchor" aria-label="anchor" href="#control-with-expressions"></a>
</h3>
<p>The expression <code>expr</code> in <code><a href="../reference/paintr.html">paintr()</a></code> is
essential to the functionality of <code>ggpaintr</code>. It controls
what type of plot the shiny app can make and what functionalities the
shiny app provides. In general, a valid <code>expr</code> is as the
following:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>geom_<span class="sc">&lt;</span>chart<span class="sc">&gt;</span>(<span class="fu">aes</span>(<span class="sc">&lt;</span>mapping_1<span class="sc">&gt;</span>, <span class="sc">&lt;</span>mapping_2<span class="sc">&gt;</span>, ...), <span class="sc">&lt;</span>geom_args_1<span class="sc">&gt;</span>, <span class="sc">&lt;</span>geom_args_2<span class="sc">&gt;</span>, ...) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="er">&lt;</span>plot_settings_1<span class="sc">&gt;</span> <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="er">&lt;</span>plot_settings_2<span class="sc">&gt;</span> <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  ...</span></code></pre></div>
<ul>
<li>
<code>geom_&lt;chart&gt;</code> can be any <code>geom_</code>
functions in <code>ggplot2</code> as long as the required aesthetic
mappings are correctly provided.</li>
<li>
<code>&lt;mapping_*&gt;</code> are the key names for the aesthetic
mapping. Currently, we have implemented <code>x</code>, <code>y</code>,
<code>z</code>, <code>fill</code>, <code>color</code>,
<code>shape</code>, <code>size</code>, and <code>group</code>. These are
the most commonly used aesthetic mappings and will allow users of the
shiny app to select variables from the dataset for a specific mapping.
The UI elements of these mapping key names are implemented with
<code><a href="https://dreamrs.github.io/shinyWidgets/reference/pickerInput.html" class="external-link">shinyWidgets::pickerInput()</a></code>, which allow users to select
and deselect.</li>
<li>
<code>&lt;geom_args_*&gt;</code> are the key names for arguments
passed into the <code>geom_&lt;chart&gt;</code> function. Currently, we
have implemented <code>alpha</code>, <code>size</code>,
<code>position</code>, and <code>stat</code>. The UI elements of
<code>size</code> and <code>alpha</code> accept numeric inputs, and the
UI elements of <code>position</code> and <code>stat</code> are
<code><a href="https://dreamrs.github.io/shinyWidgets/reference/pickerInput.html" class="external-link">shinyWidgets::pickerInput()</a></code>, which provides a list of
options for the users. We are able to use strings to control
<code>position</code> and <code>stat</code> but have not included all
the string options. Since <code>position</code>, <code>stat</code>, and
other arguments of a <code>geom_&lt;chart&gt;</code> can be very
complicated in <code>ggplot2</code>. We plan to have a more
sophisticated way of handling the arguments in the future.</li>
<li>
<code>&lt;plot_settings_*&gt;</code> are the key names for functions
that can modify the plot in higher layers. Currently, we have
implemented <code>coord_flip</code>, <code>facet_grid</code>,
<code>theme_choose</code>, <code>scale_color</code>,
<code>scale_fill</code>,
<code>theme(legend.position, legend.direction, legend.box)</code>, and
<code>labs(x, y, title, subtitle)</code>. Note that
<code>theme_choose</code> allows users of the shiny app to choose themes
from a list (<code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic()</a></code>,
<code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal()</a></code>) and is not a
function in <code>ggplot2</code>. This shows that both the key names and
the ui and server part associated with the key name can be customized.
Another thing worth noting is that <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code> in
<code>ggplot2</code> is very powerful but we only have implementations
for three of its parameters: <code>legend.position</code>,
<code>legend.direction</code>, and <code>legend.box</code>. We were able
to implement these three parameters because they require strings instead
of <code>ggplot2::element_*</code>.
<code>labs(x, y, title, subtitle)</code> is similar to
<code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code>. And currently, <code>labs</code> can only set
labels for <code>x</code>, <code>y</code>, <code>title</code>, and
<code>subtitle</code>. <code>scale_color</code> and
<code>scale_fill</code> will be discussed later.</li>
</ul>
</div>
<div class="section level3">
<h3 id="modularity">Modularity<a class="anchor" aria-label="anchor" href="#modularity"></a>
</h3>
<p>The idea of modularized shiny app largely inspired our design of
<code>ggpaintr</code>. Each key name, no matter it is
<code>&lt;mapping&gt;</code>, <code>&lt;geom_args&gt;</code>, or
<code>&lt;plot_settings&gt;</code>, can be considered as a module. It
can have its own ui and server functions and is independent of other key
names’ modules. Once the key name is included in the <code>expr</code>
of <code><a href="../reference/paintr.html">paintr()</a></code>, its ui function will be executed when
<code><a href="../reference/paintr.html">paintr()</a></code> is called, and its server function will be
executed when <code><a href="../reference/paintr_plot_code.html">paintr_plot_code()</a></code> is called. Modularization
allows us to implement different modules independently and provides the
possibility for other developers to include their own modules. It also
provides the flexibility in building shiny apps using
<code>ggpaintr</code>. At the same time, maintaining and updating
certain features of a shiny app become easier since we only need to work
on the module that is responsible for the change.</p>
</div>
<div class="section level3">
<h3 id="flexibility-in-ui-design">Flexibility in UI Design<a class="anchor" aria-label="anchor" href="#flexibility-in-ui-design"></a>
</h3>
<p>Developers who build shiny apps using <code>ggpaintr</code> have a
lot of freedom in their design of the user interface. The UI element of
a key name can be obtained by <code><a href="../reference/paintr_get_ui.html">paintr_get_ui()</a></code>, and a
developer has full control on how or where to put it in the shiny app.
If the default UI element of a key name does not meet the need of a
developer, one can provide their own ui functions and override the
default.</p>
</div>
<div class="section level3">
<h3 id="reactivity">Reactivity<a class="anchor" aria-label="anchor" href="#reactivity"></a>
</h3>
<p><code>scale_color</code> and <code>scale_fill</code> allow users of
the shiny app to manually select colors for <code>color</code> and
<code>fill</code>, respectively. Since <code>color</code> and
<code>fill</code> have similar behaviors, we will use <code>color</code>
for further explanation. If a numerical variable is mapped to
<code>color</code>, <code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient()</a></code> is used, and
users can select one color for <code>low</code> and another color for
<code>high</code>; if a categorical variable is mapped to
<code>color</code>, <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual()</a></code> is used, and the
colors selected by the users are passed into the parameter
<code>values</code> of <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual()</a></code>. If the
categorical variable has more than 11 levels, the server function for
<code>scale_color</code> will refuse to render the ui for choosing
colors and give a warning message.</p>
<p>The ui for choosing colors are implemented with
<code><a href="https://rdrr.io/pkg/colourpicker/man/colourInput.html" class="external-link">colourpicker::colourInput</a></code> and depends on the selected
variable of <code>color</code> or <code>fill</code> mapping. That is,
the reactivity between <code>scale_color</code> and <code>color</code>
requires the existence of <code>color</code> and some user input, and
thus it cannot be established at the same time when the reactive value
of <code><a href="../reference/paintr.html">paintr()</a></code> is created. To solve this problem, we
implemented a function called
<code><a href="../reference/scaleColor_build_reactivity.html">scaleColor_build_reactivity()</a></code>, which can establish the
reactivity for both <code>color</code> and <code>fill</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scaleColor_build_reactivity.html">scaleColor_build_reactivity</a></span><span class="op">(</span></span>
<span>  <span class="va">id</span>, </span>
<span>  <span class="va">paintr_obj</span>, </span>
<span>  <span class="va">color_or_fill</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>id</code> should be the same <code>id</code> used for
<code><a href="../reference/paintr.html">paintr()</a></code>. This ensures that the modules share the same name
space.</li>
<li>
<code>paintr_obj</code> is a reactive value of a
<code>paintr_obj</code> object created by <code><a href="../reference/paintr.html">paintr()</a></code>
</li>
<li>
<code>color_or_fill</code> specifies <code>color</code> or
<code>fill</code>
</li>
</ul>
<p>In order to add reactivity for <code>fill</code> in our demo shiny
app, one should make the following changes:</p>
<ul>
<li>
<p>change the expression <code>expr</code> to include
<code>scale_fill</code> and establish the reactivity:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paintr_rctv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="op">{</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html" class="external-link">req</a></span><span class="op">(</span><span class="fu">data_container</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="../reference/paintr.html">paintr</a></span><span class="op">(</span><span class="va">control_id</span>,</span>
<span>           <span class="fu">data_container</span><span class="op">(</span><span class="op">)</span>, data_path <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">defaultData</span>,</span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">fill</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>               <span class="va">coord_flip</span> <span class="op">+</span></span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">title</span><span class="op">)</span> <span class="op">+</span></span>
<span>               <span class="va">scale_fill</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scale_fill_rctv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scaleColor_build_reactivity.html">scaleColor_build_reactivity</a></span><span class="op">(</span><span class="va">control_id</span>, <span class="va">paintr_rctv</span>, <span class="st">"fill"</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>modify the ui output:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span><span class="op">$</span><span class="va">controlPanel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html" class="external-link">renderUI</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html" class="external-link">req</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/column.html" class="external-link">column</a></span><span class="op">(</span></span>
<span>        <span class="fl">12</span>,</span>
<span>        <span class="fu"><a href="../reference/paintr_get_ui.html">paintr_get_ui</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span>, <span class="st">"x"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="../reference/paintr_get_ui.html">paintr_get_ui</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span>, <span class="st">"y"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="../reference/paintr_get_ui.html">paintr_get_ui</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span>, <span class="st">"fill"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="../reference/paintr_get_ui.html">paintr_get_ui</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span>, <span class="st">"coord_flip"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="../reference/paintr_get_ui.html">paintr_get_ui</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span>, <span class="st">"labs"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="../reference/paintr_get_ui.html">paintr_get_ui</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span>, <span class="st">"scale_fill"</span><span class="op">)</span> <span class="co"># added for scale_fill</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>pass the reactive object <code>scale_fill_rctv</code> into
<code><a href="../reference/paintr_plot_code.html">paintr_plot_code()</a></code></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paintr_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/paintr_plot_code.html">paintr_plot_code</a></span><span class="op">(</span><span class="fu">paintr_rctv</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                   selected_fill_rctv <span class="op">=</span> <span class="va">scale_fill_rctv</span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="extensibility">Extensibility<a class="anchor" aria-label="anchor" href="#extensibility"></a>
</h3>
<p>This part needs some future work.</p>
</div>
</div>
<div class="section level2">
<h2 id="case-study-2-ggpaintr_app">Case Study 2: <code>ggpaintr_app</code><a class="anchor" aria-label="anchor" href="#case-study-2-ggpaintr_app"></a>
</h2>
<p>A shiny app called <code>ggpaintr_app</code> is built with the
<code>ggpaintr</code> package and included in the package.
<code>ggpaintr_app</code> not only demonstrates the functionality of
<code>ggpaintr</code>, but also serves as a shiny app for those
unfamiliar with the Grammar of Graphics or ggplot2 but want to create a
plot using ggplot2. Some design of <code>ggpaintr_app</code> can also
provide reference for package/shiny app developers.</p>
<div class="section level3">
<h3 id="run-the-shiny-app">Run the shiny app<a class="anchor" aria-label="anchor" href="#run-the-shiny-app"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://willju-wangqian.github.io/ggpaintr/">ggpaintr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/run_ggpaintr_app.html">run_ggpaintr_app</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="home-page">Home page<a class="anchor" aria-label="anchor" href="#home-page"></a>
</h3>
<p>Our <strong>Home</strong> page gives a brief introduction about the
<strong>ggpaintr</strong> package and the corresponding shiny app,it
also includes our GitHub repository link, which can direct users to our
package codes if needed.</p>
<div class="figure">
<img src="images/homepage.png" alt="Homepage." width="100%"><p class="caption">
Homepage.
</p>
</div>
</div>
<div class="section level3">
<h3 id="paintr-page">Paintr page<a class="anchor" aria-label="anchor" href="#paintr-page"></a>
</h3>
<p>The <strong>Paintr</strong> page is the main user interface of the
app, this page is further divided into three tabs, which are
<strong>Data</strong>, <strong>Paint</strong>, and
<strong>Code</strong>.</p>
<div class="section level4">
<h4 id="data-tab">1.<code>Data</code> tab<a class="anchor" aria-label="anchor" href="#data-tab"></a>
</h4>
<p>Under <strong>Data</strong>, users are allowed to either upload data
set from their local file folders, or select a data set from Base R
database.</p>
<div class="figure">
<img src="images/paintrpage.png" alt="Paintr page." width="100%"><p class="caption">
Paintr page.
</p>
</div>
<p>Once the data set is loaded, users can see partial example of the
data set and even filter the data before moving to the next step.</p>
<div class="figure">
<img src="images/filter.png" alt="Filter function." width="100%"><p class="caption">
Filter function.
</p>
</div>
</div>
<div class="section level4">
<h4 id="paint-tab">2.<code>Paint</code> tab<a class="anchor" aria-label="anchor" href="#paint-tab"></a>
</h4>
<p>Under <strong>Paint</strong>, there are image icons to present all
types of plots currently available in our shiny app, these image icons
allow users to choose the type of plot they would like to draw in a more
intuitive manner.</p>
<p>Once the type of plot is chosen, the corresponding mapping options
box will pop up. Here, we have embedded <strong>basic mapping</strong>
options such as <code>x</code>, <code>y</code>, <code>color</code>,
<code>fill</code>, and <code>size</code>; we also included
<strong>advanced setting</strong> where users can modify the
<code>legend</code>,<code>coordinate</code>, <code>theme</code>,
<code>labels</code> or facet the plot.</p>
<div class="figure">
<img src="images/Paint.png" alt="Paint page." width="100%"><p class="caption">
Paint page.
</p>
</div>
<p>What’s more, in order to meet different aesthetic needs, it also
allows users to freely choose colors for their plots.</p>
<div class="figure">
<img src="images/choosecolor.png" alt="Paint page." width="100%"><p class="caption">
Paint page.
</p>
</div>
<p>Once all the mapping variables and setting options are chosen, users
can click the <strong>Draw the plot</strong> button and the plot will
show up automatically. Here is an example of a scatter plot drew with
the iris data.</p>
<div class="figure">
<img src="images/scatterplot.png" alt="Example plot." width="100%"><p class="caption">
Example plot.
</p>
</div>
</div>
<div class="section level4">
<h4 id="code-tab">3.<code>Code</code> tab<a class="anchor" aria-label="anchor" href="#code-tab"></a>
</h4>
<p>Although we have included most of the mapping and aesthetic options
for drawing a plot in our shiny app, we want to give users more freedom
to modify their plots if needed. Therefore, the code for drawing the
plot will also be provided once a plot is made. Simply copy and paste
the code into R console and run it will generate an identical plot as
the shiny app does. Modify the codes and draw your dream plot is also
encouraged.</p>
<div class="figure">
<img src="images/code.png" alt="Example code." width="100%"><p class="caption">
Example code.
</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this project, we introduced an open-source <code>R</code> package
<code>ggpaintr</code> for building modularized shiny apps with plotting
functionalities using <code>ggplot2</code> and the idea of the Grammar
of Graphics. We showcased what <code>ggpaintr</code> can do with two
case studies in this project and discussed the thoughts and decisions we
had in the designs of <code>ggpaintr</code>. We combined the idea of
modularization and the Grammar of Graphics and implemented independent
modules that are responsible for different pieces of the plotting
functionality of a shiny app. <code>ggpaintr</code> makes it easier to
embed reactive plotting functionality in a shiny app and provides
simplicity, flexibility, and extensibility. With the help of
<code>ggpaintr</code>, reactive plotting in a shiny app can be easily
achieved and updated since an expression in <code>ggplot2</code>-alike
syntax can control which modules or reactivity to be included in the
shiny app. So far, we only implemented the most commonly used and basic
features of <code>ggplot2</code>. However, as an open-source
<code>R</code> package, developers can easily develop their own modules,
cover more aspects of <code>ggplot2</code>, and make suggestions and
improvements for <code>ggpaintr</code>. We aim to build a bridge between
<code>ggplot2</code> and shiny apps, connecting versatility and
interactivity. We hope that <code>ggpaintr</code> can make it easier for
statistics researchers and educators to build interactive data
visualizations, lower the bar on learning <code>ggplot2</code> while
keeping its elegance and flexibility, and in turn encourage more
students to step into this field.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Doi2016" class="csl-entry">
Doi, Jimmy A., Gail E. Potter, Jimmy Wong, Irvin Alcaraz, and Peter Chi.
2016. <span>“Web Application Teaching Tools for Statistics Using r and
Shiny.”</span> <em>Technology Innovations in Statistics Education</em>
9.
</div>
<div id="ref-Wickham2016" class="csl-entry">
Wickham, H. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>.
Use r! Springer International Publishing. <a href="https://books.google.com/books?id=RTMFswEACAAJ" class="external-link">https://books.google.com/books?id=RTMFswEACAAJ</a>.
</div>
<div id="ref-Wickham2010" class="csl-entry">
Wickham, Hadley. 2010. <span>“A Layered Grammar of Graphics.”</span>
<em>Journal of Computational and Graphical Statistics</em> 19 (1): 3–28.
<a href="https://doi.org/10.1198/jcgs.2009.07098" class="external-link">https://doi.org/10.1198/jcgs.2009.07098</a>.
</div>
<div id="ref-Wilkinson2005" class="csl-entry">
Wilkinson, Lee, Anushka Anand, and Raymond Harold Grossman. 2005.
<span>“Graph-Theoretic Scagnostics.”</span> <em>IEEE Symposium on
Information Visualization, 2005. INFOVIS 2005.</em>, 157–64.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Wangqian Ju, Jinji Pang, Zhili Qiao.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
